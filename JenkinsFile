@Library('jenkins-shared-library')_
pipeline {
    agent any
    tools {
        maven "Maven"   
    }   
  
    stages {
        stage('Compile-Build-Test ') {
            steps {
	    	slackNotify 'Building Started'
                build 'BUILD'
            }
        }
        stage('SonarQube Analysis'){
            steps{
               sonar 'SONAR'
            }
        }
	     stage('Nexus') {
    		 steps{
          		nexus 'NEXUS' 
       			}
		   }
		stage("Tomcat Deployment"){
			steps{
			 withCredentials([string(credentialsId: 'ansible_credentials', variable: 'password')]){
                    sh 'sshpass -p ${password} ssh -o StrictHostKeyChecking=no ansadmin@172.31.10.200 -C \"ansible-playbook /opt/playbooks/download.yml\"'
                }
			}
		}
		
      }
	}
